?lapply
?split
library(datasets)
data(iris)
data
?iris
str(iris)
mean(iris$Sepal.Length,na.rm=TRUE)
mean(iris$Sepal.Length,na.rm=TRUE)
iris
apply(iris[,1:4],2,mean)
library(datasets)
data(mtcars)
mtcars
?tapply
tapply(mtcars$cyl, mtcars$mpg, mean)
apply(mtcars, 2, mean)
cylFour<-subset(mtcars,mtcars$cyl==4)
cylEight<-subset(mtcars,mtcars$cyl==8)
cylFour
mean(cylFour$hp)-mean(cylEight$hp)
debug(ls)
ls(asd,fd)
?ls
0
.Ob <- 1
ls(pattern = "O")
?debug
iris
v<-subset(iris,Species==virginica)
v<-subset(iris,iris$Species==virginica)
v<-subset(iris,iris$Species==virginica)
iris
v<-subset(iris,iris$Species==virinica)
v<-subset(iris,iris$Species==virginica)
iris.$Species
iris$Species
iris$Species==virginica
v<-subset(iris,iris$Species=="virginica")
v
mean(v$Sepal.Length)
sapply(mtcars, cyl, mean)
tapply(mtcars$cyl, mtcars$mpg, mean)
mtcar
mtcars
q()
library(kernlab)
data(spam)
spam$capitalAveSq<-spam$capitalAve^2
library(ISLR)
library(caret)
data(Wage)
inTrain<-createDataPartition(y=Wage$wage,p=0.7,list=FALSE)
training<-Wage[inTrain,]
testing<-Wage[-inTrain,]
testing<-Wage[-inTrain,]
dummies<-dummyVars(wave~jobclass,data=training)
library(ISLR)
library(caret)
data(Wage)
inTrain<-createDataPartition(y=Wage$wage,p=0.7,list=FALSE)
training<-Wage[inTrain,]
testing<-Wage[-inTrain,]
##turn qualititive variable to quantitative
dummies<-dummyVars(wave~jobclass,data=training)
dummies<-dummyVars(wave~jobclass,data=training)
dummies<-dummyVars(wage~jobclass,data=training)
head(predict(dummies,newdata=training))
?dummyVars
nsv<-nearZeroVar(training,saveMetrics=TRUE)
nsv
bsBasis<-bs(training#age,df=3)
bsBasis<-bs(training$age,df=3)
install.packages()
library(splines)
?splines
bsBasis<-bs(training$age,df=3)
bsBasis
points(training$age,predict(lm1,newdata=training),col="red",pch-19,cex=0.5)
plot(training$age,training,pch=19,cex=0.5)
lm1<-lm(wage~basBasis,data=training)
lm1<-lm(wage~bsBasis,data=training)
plot(training$age,training,pch=19,cex=0.5)
plot(training$age,training$wage,pch=19,cex=0.5)
points(training$age,predict(lm1,newdata=training),col="red",pch-19,cex=0.5)
lm1<-lm(wage~bsBasis,data=training)
plot(training$age,training$wage,pch=19,cex=0.5)
points(training$age,predict(lm1,newdata=training),col="red",pch-19,cex=0.5)
points(training$age,predict(lm1,newdata=training),col="red",pch=19,cex=0.5)
predict(bsBasis,age=testing$age)
q()
?bs
?preProcess
data(spam)
inTrain<-createDataPartition(y=spam$type,p=0.75,list=FALSE)
Training<-spam[inTrain,]
testing<-spam[-inTrain,]
M<-abs(cor(cor(training[,-58])))
M<-abs(cor(training[,-58]))
library(caret)
library(kernlab)
data(spam)
inTrain<-createDataPartition(y=spam$type,p=0.75,list=FALSE)
Training<-spam[inTrain,]
testing<-spam[-inTrain,]
M<-abs(cor(training[,-58]))
diag(M)<-0
which(M>0.8,arr.ind=T)
training
training[,-58]
str(training[,-58])
str(training[,-57])
?cor
local({pkg <- select.list(sort(.packages(all.available = TRUE)),graphics=TRUE)
if(nchar(pkg)) library(pkg, character.only=TRUE)})
?abs
library(stats)
M<-abs(cor(training[,-58]))
training[,-58]
smallSpam<-spam[,c(34,22)]
prComp<-prcomp(smallSpam)
plot(prComp$x[,1],prComp$x[,2])
prComp$rotation
typeColor<-((spam$type=="spam")*1+1)
prComp<-prcomp(log10(spam[,-58]+1))
plot(prComp$x[,1],prComp$x[,2],col=typeColor,xlab="PC1",ylab="PC2")
preProc<-preProcess(log10(spam[,-58]+1),method="pca",pcaComp=2)
trainPC<-predict(preProc,log10(training[,-58]+1))
?preProcess
?predict
library(caret)
data(faithful)
set.seed(333)
inTrain<-createDataPartition(y=faithful$waiting,p=0.5,list=FALSE)
trainFaith<-faithful[inTrain,]
testFaith<-faithful[-inTrain,]
head(trainFaith)
head(trainFaith)
plot(trainFaith$waiting,trainFaith#eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
library(caret)
data(faithful)
set.seed(333)
inTrain<-createDataPartition(y=faithful$waiting,p=0.5,list=FALSE)
trainFaith<-faithful[inTrain,]
testFaith<-faithful[-inTrain,]
head(trainFaith)
plot(trainFaith$waiting,trainFaith#eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
plot(trainFaith$waiting,trainFaith#eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
?pch
lm1<-lm(eruptoions~waiting,data=trainFaith)
lm1<-lm(eruptoions~waiting,data=trainFaith)
lm1<-lm(eruptions~waiting,data=trainFaith)
summary(lm1)
lines(trainFaith$waiting,lm$fitted,lwd=3)
lines(trainFaith$waiting,lm$fitted,lwd=3)
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
##fit linear model
lm1<-lm(eruptions~waiting,data=trainFaith)
summary(lm1) ##'Estimate' is predicted value
##model fit
lines(trainFaith$waiting,lm$fitted,lwd=3)
lines(trainFaith$waiting,lm1$fitted,lwd=3)
##load data
library(caret)
data(faithful)
set.seed(333)
inTrain<-createDataPartition(y=faithful$waiting,p=0.5,list=FALSE)
trainFaith<-faithful[inTrain,]
testFaith<-faithful[-inTrain,]
head(trainFaith)
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
##fit linear model
lm1<-lm(eruptions~waiting,data=trainFaith)
summary(lm1) ##'Estimate' is predicted value
##model fit
lines(trainFaith$waiting,lm1$fitted,lwd=3)
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
##regression model
##load data
library(caret)
data(faithful)
set.seed(333)
inTrain<-createDataPartition(y=faithful$waiting,p=0.5,list=FALSE)
trainFaith<-faithful[inTrain,]
testFaith<-faithful[-inTrain,]
head(trainFaith)
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
##fit linear model
lm1<-lm(eruptions~waiting,data=trainFaith)
summary(lm1) ##'Estimate' is predicted value
##model fit
lines(trainFaith$waiting,lm1$fitted,lwd=3)
library(caret)
data(faithful)
set.seed(333)
inTrain<-createDataPartition(y=faithful$waiting,p=0.5,list=FALSE)
trainFaith<-faithful[inTrain,]
testFaith<-faithful[-inTrain,]
head(trainFaith)
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
##fit linear model
lm1<-lm(eruptions~waiting,data=trainFaith)
summary(lm1) ##'Estimate' is predicted value
##model fit
lines(trainFaith$waiting,lm1$fitted,lwd=3)
lines(trainFaith$waiting,lm1$fitted,lwd=3)
lines(trainFaith$waiting,lm1$fitted,lwd=3)
lines(trainFaith$waiting,lm1$fitted,lwd=3)
lines(trainFaith$waiting,lm1$fitted,lwd=3)
lines(trainFaith$waiting,lm1$fitted,lwd=3)
utils:::menuInstallPkgs()
newdata<-data.frame(waiting=80)
predict(lm1,newdata)
par(mfrow=c(1,2))
plplot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(trainFaith$waiting,predict(lm1),lwd=3)
plot(testFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(testFaith$waiting,predict(lm1),lwd=3)
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(trainFaith$waiting,predict(lm1),lwd=3)
plot(testFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(testFaith$waiting,predict(lm1),lwd=3)
lines(testFaith$waiting,predict(lm1),lwd=3)
lines(testFaith$waiting,predict(lm1),lwd=3)
par(mfrow=c(1,2))
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(trainFaith$waiting,predict(lm1),lwd=3)
plot(testFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(testFaith$waiting,predict(lm1),lwd=3)
par(mfrow=c(1,2))
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(trainFaith$waiting,predict(lm1),lwd=3)
plot(testFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
plot(testFaith$waiting,testFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(testFaith$waiting,predict(lm1),lwd=3)
plot(testFaith$waiting,testFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(testFaith$waiting,predict(lm1),lwd=3)
lines(testFaith$waiting,predict(lm1,newdata=testFaith),lwd=3)
newdata<-data.frame(waiting=80)
predict(lm1,newdata)
par(mfrow=c(1,2))
plot(trainFaith$waiting,trainFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(trainFaith$waiting,predict(lm1),lwd=3)
plot(testFaith$waiting,testFaith$eruptions,pch=19,col="blue",xlab="Waiting",ylab="Duration")
lines(testFaith$waiting,predict(lm1,newdata=testFaith),lwd=3)
lines(testFaith$waiting,predict(lm1,newdata=testFaith),lwd=3)
lines(testFaith$waiting,predict(lm1,newdata=testFaith),lwd=3)
lines(testFaith$waiting,predict(lm1,newdata=testFaith),lwd=3)
lines(testFaith$waiting,predict(lm1,newdata=testFaith),lwd=3)
lines(testFaith$waiting,predict(lm1,newdata=testFaith),lwd=3)
lines(testFaith$waiting,predict(lm1,newdata=testFaith),lwd=3)
sqrt(sum((lm1$fitted-trainFaith$eruptions)^2))
sqrt(sum((predict(lm1,newdata=tsetFaith)-trainFaith$eruptions)^2))
sqrt(sum((predict(lm1,newdata=testFaith)-trainFaith$eruptions)^2))
sqrt(sum((predict(lm1,newdata=testFaith)-testFaith$eruptions)^2))
matlines(testFaith$waiting[ord],pred1[ord,]type='l',,col=c(1,2,2),lty=c(1,1,1),lwd=3)
matlines(testFaith$waiting[ord],pred1[ord,],type='l',,col=c(1,2,2),lty=c(1,1,1),lwd=3)
pred1<-predict(lm1,newdata=testFaith,inteval="prediction")
ord<-order(testFaith$waiting)
plot(testFaith$waiting,testFaith$eruptions,pch=19,col="blue")
matlines(testFaith$waiting[ord],pred1[ord,],type='l',,col=c(1,2,2),lty=c(1,1,1),lwd=3)
matlines(testFaith$waiting[ord],pred1[ord,],type="l",,col=c(1,2,2),lty=c(1,1,1),lwd=3)
pred1<-predict(lm1,newdata=testFaith,inteval="prediction")
ord<-order(testFaith$waiting)
plot(testFaith$waiting,testFaith$eruptions,pch=19,col="blue")
matlines(testFaith$waiting[ord],pred1[ord,],type="l",,col=c(1,2,2),lty=c(1,1,1),lwd=3)
?featurePlot
featurePlot(x=training[,c("age","education","jobclass")],y=training$wage,plot="pairs")
q()
